# ğŸ“š ×”×¡×‘×¨: ××”×™×›×Ÿ ×‘××•×ª ×”×ª×›×•× ×•×ª?

**×ª××¨×™×š**: 20 ×‘××•×§×˜×•×‘×¨ 2025  
**×©××œ×”**: ××”×™×›×Ÿ ×× ×™ ××¦×™×¢ ×œ×©×œ×‘ ××•×ª×Ÿ? ×—×‘×™×œ×ª ×—×™×¤×•×© ××• ××©×”×• ××—×¨?

---

## ğŸ¯ ×ª×©×•×‘×” ×§×¦×¨×”

**×›×œ ××—×ª ××”×ª×›×•× ×•×ª ×‘××” ×××§×•×¨ ××—×¨:**

| ×ª×›×•× ×” | ××§×•×¨ | ×¡×˜×˜×•×¡ | ×¡×•×’ ×”×©×™×œ×•×‘ |
|-------|------|-------|-----------|
| **#1 Elasticsearch** | âœ… ×—×‘×™×œ×” ××•×ª×§× ×ª | ××•×¤×¢×œ ××‘×œ ×œ× ×× ×•×¦×œ | ×©×™×œ×•×‘ ×©×œ ×§×•×“ ×§×™×™× |
| **#2 Passim** | âš ï¸ ×—×‘×™×œ×” ×—×™×¦×•× ×™×ª | ××•×¤×¢×œ ××‘×œ ×—×¡×¨ container | ×¦×¨×™×š ×œ×”×ª×§×™×Ÿ + ×œ×©×œ×‘ |
| **#3 Analytics** | ğŸ”¨ ×œ×‘× ×•×ª ×××¤×¡ | ×œ× ×§×™×™× | ×‘× ×™×” ×¢×¦×××™×ª ××œ××” |
| **#4 Error Detection** | ğŸ”¨ ×œ×‘× ×•×ª ×××¤×¡ | ×œ× ×§×™×™× | ×‘× ×™×” ×¢×¦×××™×ª ××œ××” |

---

## ğŸ” ×¤×™×¨×•×˜ ××¤×•×¨×˜ ×œ×›×œ ×ª×›×•× ×”

### 1ï¸âƒ£ Elasticsearch - ×—×™×¤×•×© ××ª×§×“× âœ… (×›×‘×¨ ×©×™×œ×‘× ×•!)

#### ××”×™×›×Ÿ ×–×” ×‘×?
```yaml
××§×•×¨: ×—×‘×™×œ×ª Elasticsearch (××•×ª×§× ×ª ×•×¤×•×¢×œ×ª)
Docker: escriptorium_clean-elasticsearch-1
Port: 9200
Package: elasticsearch==7.17.0
```

**××” ×©×›×‘×¨ ×”×™×”:**
- âœ… Container Docker ×¨×¥
- âœ… Python client ××•×ª×§×Ÿ
- âœ… ××©×ª× ×™× ×‘-variables.env
- âœ… ×—×™×‘×•×¨ ×œ×¨×©×ª Docker

**××” ×©×”×•×¡×¤× ×• (××ª××•×œ):**
- âœ… ElasticsearchService (search.py)
- âœ… 4 Celery tasks
- âœ… 2 API endpoints
- âœ… Frontend interface
- âœ… i18n ×‘×¢×‘×¨×™×ª/×¦×¨×¤×ª×™×ª

**ğŸ“ ×œ×™××•×“:**
×–×” **×œ×** ×—×‘×™×œ×” ×—×“×©×” - ×–×” **×©×™×œ×•×‘ ×©×œ ×§×•×“** ×¢× ×—×‘×™×œ×” ×§×™×™××ª!

---

### 2ï¸âƒ£ Passim - Text Alignment âš ï¸

#### ××”×™×›×Ÿ ×–×” ×‘×?
```yaml
××§×•×¨: ×¤×¨×•×™×§×˜ Passim (×—×™×¦×•× ×™ ×œ-eScriptorium)
GitHub: https://github.com/dasmiq/passim
Type: Java/Scala application
License: Apache 2.0
××™×•×¢×“: ×–×™×”×•×™ ×§×˜×¢×™ ×˜×§×¡×˜ ×—×•×–×¨×™×
```

**××” ×©×›×‘×¨ ×™×©:**
```bash
# variables.env
TEXT_ALIGNMENT=true  # âœ… ××•×¤×¢×œ
```

**××” ×©×—×¡×¨:**
1. âŒ Docker container ×©×œ Passim (Java)
2. âŒ Celery worker ×œ-JVM tasks
3. âŒ Python wrapper ×œ-API
4. âŒ Frontend viewer

**ğŸ“ ×œ×™××•×“:**
×–×” **×—×‘×™×œ×” ×—×™×¦×•× ×™×ª** ×©×¦×¨×™×š ×œ×”×ª×§×™×Ÿ + ×œ×›×ª×•×‘ integration layer.

**××” × ×“×¨×© ×œ×¢×©×•×ª:**

#### A. ×”×•×¡×¤×ª Docker Container
```yaml
# docker-compose.yml
passim:
  image: scripta/passim:latest  # ××• ×œ×‘× ×•×ª custom
  container_name: biblia-passim
  ports:
    - "8983:8983"
  volumes:
    - passim_data:/data
  environment:
    - JAVA_OPTS=-Xmx4g
  networks:
    - biblia-network
```

#### B. Python Integration
```python
# app/apps/core/passim_client.py

import requests

class PassimClient:
    """
    Client ×œ-Passim API
    """
    def __init__(self):
        self.base_url = "http://passim:8983"
    
    def align_texts(self, text1, text2, min_length=10):
        """
        ××•×¦× ×§×˜×¢×™× ×“×•××™× ×‘×™×Ÿ ×©× ×™ ×˜×§×¡×˜×™×
        """
        response = requests.post(
            f"{self.base_url}/align",
            json={
                'text1': text1,
                'text2': text2,
                'min_match_length': min_length
            }
        )
        return response.json()
```

#### C. Celery Task
```python
# app/apps/core/tasks.py

@shared_task(queue='jvm')  # ×ª×•×¨ × ×¤×¨×“ ×œ-Java tasks
def align_documents(doc1_id, doc2_id):
    client = PassimClient()
    # ... ×©××¨ ×”×§×•×“
```

**ğŸ“ ×¡×™×›×•×:**
- **×—×‘×™×œ×” ×—×™×¦×•× ×™×ª** (Java/Scala)
- ×¦×¨×™×š Docker container × ×¤×¨×“
- ×¦×¨×™×š Python wrapper
- ×¦×¨×™×š Frontend viewer
- **×–××Ÿ ××©×•×¢×¨**: 8-10 ×©×¢×•×ª

---

### 3ï¸âƒ£ Analytics Dashboard - ×œ×•×— ×‘×§×¨×” ğŸ”¨

#### ××”×™×›×Ÿ ×–×” ×‘×?
```yaml
××§×•×¨: âŒ ×œ× ×§×™×™×! ×¦×¨×™×š ×œ×‘× ×•×ª ×××¤×¡
×”×©×¨××”: eScriptorium ××§×•×¨×™ (×™×© ×œ×”× dashboard ×¤×©×•×˜)
×¡×¤×¨×™×•×ª: Chart.js / D3.js (×œ×’×¨×¤×™×)
```

**××” ×©×›×‘×¨ ×™×©:**
```python
# × ×ª×•× ×™× ×§×™×™××™× ×‘-DB:
- LineTranscription.confidence
- DocumentPart.created/updated
- Project statistics
- User activity logs
```

**××” ×©×—×¡×¨ (×”×›×œ!):**
1. âŒ Models ×—×“×©×™× (OCRMetrics, CharacterConfusion, ProjectProgress)
2. âŒ API endpoints ×œ×× ×œ×™×˜×™×§×¡
3. âŒ Frontend Vue components
4. âŒ ×¡×¤×¨×™×•×ª ×’×¨×¤×™× (Chart.js)
5. âŒ Celery tasks ×œ××™×¡×•×£ ××˜×¨×™×§×•×ª

**ğŸ“ ×œ×™××•×“:**
×–×” **×‘× ×™×” ×××¤×¡** - ××‘×œ ××©×ª××©×™× ×‘× ×ª×•× ×™× ×§×™×™××™× ×•×‘×¡×¤×¨×™×•×ª ×’×¨×¤×™× ××•×›× ×•×ª.

**××” × ×“×¨×© ×œ×¢×©×•×ª:**

#### ×©×œ×‘ 1: Models (Django)
```python
# app/apps/core/models.py

class OCRMetrics(models.Model):
    """××“×“×™ ×“×™×•×§ OCR"""
    transcription = models.ForeignKey(LineTranscription)
    cer = models.FloatField()  # Character Error Rate
    wer = models.FloatField()  # Word Error Rate
    confidence_avg = models.FloatField()
    processing_time = models.DurationField()

class CharacterConfusion(models.Model):
    """××˜×¨×™×¦×ª ×‘×œ×‘×•×œ ×ª×•×•×™×"""
    model = models.ForeignKey(OcrModel)
    char_expected = models.CharField(max_length=10)
    char_predicted = models.CharField(max_length=10)
    frequency = models.IntegerField()
```

#### ×©×œ×‘ 2: API (Django REST Framework)
```python
# app/apps/api/views.py

class AnalyticsViewSet(viewsets.ViewSet):
    @action(detail=False, methods=['get'])
    def ocr_accuracy_trend(self, request):
        # ××—×–×™×¨ × ×ª×•× ×™ ×“×™×•×§ ×œ××•×¨×š ×–××Ÿ
        pass
    
    @action(detail=False, methods=['get'])
    def confusion_matrix(self, request):
        # ××˜×¨×™×¦×ª ×‘×œ×‘×•×œ ×ª×•×•×™×
        pass
```

#### ×©×œ×‘ 3: Frontend (Vue.js + Chart.js)
```vue
<!-- front/vue/components/AnalyticsDashboard.vue -->
<template>
  <div class="dashboard">
    <LineChart :data="accuracyData" />
    <HeatMap :data="confusionMatrix" />
    <ProgressBar :data="projectProgress" />
  </div>
</template>

<script>
import { Line, HeatMap } from 'vue-chartjs';
</script>
```

#### ×©×œ×‘ 4: ×”×ª×§× ×ª ×¡×¤×¨×™×•×ª
```bash
# front/package.json
npm install chart.js vue-chartjs
```

**ğŸ“ ×¡×™×›×•×:**
- **×‘× ×™×” ×××¤×¡** (××™×Ÿ ×—×‘×™×œ×” ××•×›× ×”)
- ××©×ª××©×™× ×‘× ×ª×•× ×™× ×§×™×™××™× ×‘-DB
- ××©×ª××©×™× ×‘×¡×¤×¨×™×•×ª ×’×¨×¤×™× (Chart.js)
- Frontend + Backend + API
- **×–××Ÿ ××©×•×¢×¨**: 10-12 ×©×¢×•×ª

---

### 4ï¸âƒ£ Error Detection - ×–×™×”×•×™ ×©×’×™××•×ª ğŸ”¨

#### ××”×™×›×Ÿ ×–×” ×‘×?
```yaml
××§×•×¨: âŒ ×œ× ×§×™×™×! ×¦×¨×™×š ×œ×‘× ×•×ª ×××¤×¡
×”×©×¨××”: spell checkers ×§×™×™××™× (Hunspell)
×¡×¤×¨×™×•×ª: hunspell, langdetect (Python)
```

**××” ×©×›×‘×¨ ×™×©:**
```python
# × ×ª×•× ×™× ×§×™×™××™×:
- LineTranscription.confidence (0.0-1.0)
- LineTranscription.content (×”×˜×§×¡×˜)
```

**××” ×©×—×¡×¨ (×”×›×œ!):**
1. âŒ Spell checker integration (Hunspell)
2. âŒ Models ×œ×©×’×™××•×ª (DetectedError, ErrorCorrection)
3. âŒ API endpoints ×œ×–×™×”×•×™ ×•×ª×™×§×•×Ÿ
4. âŒ Frontend interface ×œ×ª×™×§×•×Ÿ
5. âŒ ××™×œ×•× ×™× ×¢×‘×¨×™×™×/×¢×¨×‘×™×™×

**ğŸ“ ×œ×™××•×“:**
×–×” **×‘× ×™×” ×××¤×¡** + ×©×™×œ×•×‘ ×©×œ spell checker ×§×™×™× (Hunspell).

**××” × ×“×¨×© ×œ×¢×©×•×ª:**

#### ×©×œ×‘ 1: ×”×ª×§× ×ª Hunspell
```dockerfile
# Dockerfile
RUN apt-get install -y hunspell hunspell-he hunspell-ar
```

#### ×©×œ×‘ 2: Python Wrapper
```python
# app/apps/core/spell_checker.py

import hunspell
from langdetect import detect

class SpellChecker:
    def __init__(self):
        self.checkers = {
            'he': hunspell.HunSpell('/dict/he_IL.dic', '/dict/he_IL.aff'),
            'ar': hunspell.HunSpell('/dict/ar.dic', '/dict/ar.aff'),
        }
    
    def check_line(self, text, language='he'):
        """×‘×“×•×§ ×©×•×¨×ª ×˜×§×¡×˜ ×•×”×—×–×¨ ×©×’×™××•×ª"""
        checker = self.checkers[language]
        errors = []
        
        for word in text.split():
            if not checker.spell(word):
                suggestions = checker.suggest(word)[:3]
                errors.append({
                    'word': word,
                    'suggestions': suggestions
                })
        
        return errors
```

#### ×©×œ×‘ 3: Models
```python
# app/apps/core/models.py

class DetectedError(models.Model):
    """×©×’×™××” ×©×–×•×”×ª×”"""
    line_transcription = models.ForeignKey(LineTranscription)
    error_type = models.CharField(max_length=50)
    word = models.CharField(max_length=100)
    position = models.IntegerField()
    suggestions = models.JSONField()
    
class ErrorCorrection(models.Model):
    """×ª×™×§×•×Ÿ ×©×‘×•×¦×¢"""
    detected_error = models.ForeignKey(DetectedError)
    correction = models.CharField(max_length=100)
    user = models.ForeignKey(User)
    timestamp = models.DateTimeField(auto_now_add=True)
```

#### ×©×œ×‘ 4: API
```python
# app/apps/api/views.py

class ErrorDetectionViewSet(viewsets.ViewSet):
    @action(detail=True, methods=['post'])
    def check_line(self, request, pk=None):
        """×‘×“×•×§ ×©×•×¨×” ×œ×©×’×™××•×ª"""
        transcription = self.get_object()
        checker = SpellChecker()
        errors = checker.check_line(transcription.content)
        return Response({'errors': errors})
    
    @action(detail=True, methods=['post'])
    def apply_correction(self, request, pk=None):
        """×”×—×œ ×ª×™×§×•×Ÿ"""
        error = self.get_object()
        correction = request.data['correction']
        # ×©××•×¨ ×ª×™×§×•×Ÿ + ×¢×“×›×Ÿ transcription
        pass
```

#### ×©×œ×‘ 5: Frontend
```vue
<!-- front/vue/components/ErrorHighlighter.vue -->
<template>
  <div class="line-editor">
    <span 
      v-for="word in words" 
      :key="word.id"
      :class="{'error': word.hasError}"
      @click="showSuggestions(word)"
    >
      {{ word.text }}
    </span>
    
    <div v-if="selectedWord" class="suggestions">
      <button 
        v-for="suggestion in selectedWord.suggestions"
        @click="applySuggestion(suggestion)"
      >
        {{ suggestion }}
      </button>
    </div>
  </div>
</template>
```

**ğŸ“ ×¡×™×›×•×:**
- **×‘× ×™×” ×××¤×¡** + ×©×™×œ×•×‘ Hunspell
- ×¦×¨×™×š ××™×œ×•× ×™× ×¢×‘×¨×™×™×/×¢×¨×‘×™×™×
- Frontend + Backend + API
- ×œ××™×“×” ××ª×™×§×•× ×™× ×§×•×“××™×
- **×–××Ÿ ××©×•×¢×¨**: 12-15 ×©×¢×•×ª

---

## ğŸ“Š ×”×©×•×•××” ×¡×•×¤×™×ª

| ×ª×›×•× ×” | ×¡×•×’ | ×—×‘×™×œ×” ×§×™×™××ª? | ×§×•×“ ×§×™×™×? | ×¢×‘×•×“×” × ×“×¨×©×ª |
|-------|-----|--------------|-----------|-------------|
| **Elasticsearch** | ×©×™×œ×•×‘ | âœ… ×›×Ÿ (×¨×¥) | âš ï¸ ×—×œ×§×™ | 6-8h (×§×•×“ ×‘×œ×‘×“) |
| **Passim** | ×©×™×œ×•×‘ | âš ï¸ ×¦×¨×™×š ×œ×”×ª×§×™×Ÿ | âŒ ×œ× | 8-10h (container + ×§×•×“) |
| **Analytics** | ×‘× ×™×” | âš ï¸ Chart.js | âŒ ×œ× | 10-12h (×”×›×œ ×××¤×¡) |
| **Error Detection** | ×‘× ×™×” | âš ï¸ Hunspell | âŒ ×œ× | 12-15h (×”×›×œ ×××¤×¡) |

---

## ğŸ¯ ×”××œ×¦×” ×©×œ×™

### ×œ××ª×—×™×œ×™× / ×–××Ÿ ××•×’×‘×œ:
**×”×ª×—×œ ×¢× Elasticsearch** (×›×‘×¨ ×¢×©×™× ×•! âœ…)
- ×”×—×‘×™×œ×” ×›×‘×¨ ××•×ª×§× ×ª
- ×”×›×™ ××”×¨ ×œ×¨××•×ª ×ª×•×¦××•×ª
- ×¢×¨×š ××™×™×“×™ ×œ××©×ª××©×™×

### ×œ×¤×¨×•×™×§×˜ ××—×§×¨×™:
**Passim (Text Alignment)**
- ×™×™×—×•×“×™ ×œ××—×§×¨ ×”×™×¡×˜×•×¨×™
- ×××¤×©×¨ ×”×©×•×•××ª ×›×ª×‘×™ ×™×“
- ×—×‘×™×œ×” ××‘×•×¡×¡×ª (Passim ××•×›×¨)

### ×œ× ×™×”×•×œ ×¤×¨×•×™×§×˜:
**Analytics Dashboard**
- ×ª×•×‘× ×•×ª ×¢×œ ××™×›×•×ª ×”×¢×‘×•×“×”
- ××¢×§×‘ ×”×ª×§×“××•×ª
- ×–×™×”×•×™ ×‘×¢×™×•×ª ××•×§×“×

### ×œ×©×™×¤×•×¨ ×“×™×•×§:
**Error Detection**
- ××–×”×” ×©×’×™××•×ª OCR
- ××™×™×¢×œ ×ª×”×œ×™×š ×ª×™×§×•×Ÿ
- ×œ××™×“×” ××ª×™×§×•× ×™× ×§×•×“××™×

---

## ğŸ’¡ ×œ×¡×™×›×•×

**×œ×©××œ×ª×š**: "××”×™×›×Ÿ ××ª ×”××¦×™×¢ ×œ×©×œ×‘ ××•×ª×?"

### ×ª×©×•×‘×”:
1. **Elasticsearch** - âœ… **×›×‘×¨ ×©×™×œ×‘× ×•!** ×—×‘×™×œ×” ××•×ª×§× ×ª, ×›×ª×‘× ×• ×§×•×“
2. **Passim** - ×—×‘×™×œ×” ×—×™×¦×•× ×™×ª (Java), ×¦×¨×™×š container + integration
3. **Analytics** - ×‘× ×™×” ×××¤×¡, ××©×ª××©×™× ×‘-Chart.js ×œ×’×¨×¤×™×
4. **Error Detection** - ×‘× ×™×” ×××¤×¡, ××©×ª××©×™× ×‘-Hunspell ×œ××™×•×ª

**×”×›×œ ×”×•× ×©×™×œ×•×‘ ×©×œ:**
- ğŸ”¨ ×§×•×“ ×©×× ×—× ×• ×›×•×ª×‘×™× (Django + Vue)
- ğŸ“¦ ×¡×¤×¨×™×•×ª/×—×‘×™×œ×•×ª ×§×™×™××•×ª (Elasticsearch, Hunspell, Chart.js)
- ğŸ³ Docker containers (Elasticsearch, Passim)

**××£ ××—×ª ××”×ª×›×•× ×•×ª ×œ× "××’×™×¢×” ××•×›× ×” ××”×§×•×¤×¡×”"** - ×›×•×œ×Ÿ ×“×•×¨×©×•×ª integration work!

---

**××™×–×• ×ª×›×•× ×” ×ª×¨×¦×” ×œ×™×™×©× ×”×‘××”?** ğŸ¤”
